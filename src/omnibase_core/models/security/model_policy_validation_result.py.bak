from typing import Any, List

from pydantic import Field

"""
ModelPolicyValidationResult: Result of policy validation against signature chain.

This model represents the result of validating a signature chain against a trust policy.
"""

from pydantic import BaseModel, Field

from omnibase_core.models.core.model_semver import ModelSemVer

from .model_policy_severity import ModelPolicySeverity
from .model_signature_requirements import ModelSignatureRequirements


class ModelPolicyValidationResult(BaseModel):
    """Result of policy validation against a signature chain."""

    policy_id: str = Field(..., description="ID of the policy that was evaluated")
    policy_version: ModelSemVer = Field(..., description="Version of the policy")
    status: str = Field(
        ...,
        description="Validation status: compliant, warning, violated",
    )
    severity: ModelPolicySeverity = Field(
        ...,
        description="Severity level of any violations",
    )
    violations: list[str] = Field(
        default_factory=list,
        description="List of policy violations",
    )
    warnings: list[str] = Field(
        default_factory=list,
        description="List of policy warnings",
    )
    requirements: ModelSignatureRequirements = Field(
        ...,
        description="Evaluated signature requirements",
    )
    enforcement_mode: str = Field(..., description="Policy enforcement mode")
    validated_at: str = Field(..., description="Timestamp of validation")
