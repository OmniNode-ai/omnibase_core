schema_version: {major: 1, minor: 0, patch: 0}
name: "tool_message_aggregator"
uuid: "c3d4e5f6-a7b8-9012-cdef-345678901bcd"
author: "ONEX Framework Team"
created_at: "2025-08-21T00:00:00Z"
last_modified_at: "2025-08-21T00:00:00Z"
description: "Message Aggregator - Cross-group message aggregation and state management for ONEX Messaging Architecture v0.2"
state_contract: "state_contract://message_aggregator_schema.json"
lifecycle: "active"
hash: "cdef345678901bcddef345678901bcddef345678901bcddef345678901bcddef"
entrypoint:
  type: "python"
  target: "v1_0_0/node.py"
namespace: "omnibase.tools.infrastructure.tool_message_aggregator"
meta_type: "tool"
runtime_language_hint: "python>=3.11"

# === INFRASTRUCTURE TOOL METADATA ===
capabilities:
  - "message_aggregation"
  - "cross_group_coordination"
  - "state_management"
  - "postgresql_persistence"

protocols_supported:
  - "ProtocolInfrastructureAdapter"
  - "ProtocolNodeReducer"

dependencies:
  - name: "postgresql_server"
    type: "external_service"
    target: "postgresql://localhost:5432"
    binding: "runtime_lookup"
    optional: false
    description: "PostgreSQL server for aggregation state and persistent storage"

  - name: "onex_event_bus"
    type: "protocol_adherence"
    target: "ProtocolEventBus"
    binding: "injection"
    optional: false
    description: "ONEX event bus for cross-group coordination"

# === VERSION MANAGEMENT (via x_extensions) ===
x_extensions:
  version_management:
    # Current version information
    current_stable: {major: 1, minor: 0, patch: 0}
    current_development: null

    # Version catalog with lifecycle states
    versions:
      v1_0_0:
        version: {major: 1, minor: 0, patch: 0}
        status: "active"
        release_date: "2025-08-21"
        breaking_changes: false
        recommended: true
        deprecation_date: null
        end_of_life: null

    # Discovery configuration for services loading this tool
    discovery:
      auto_load_strategy: "current_stable"
      fallback_versions: [{major: 1, minor: 0, patch: 0}]
      version_directory_pattern: "v{major}_{minor}_{patch}"
      implementation_file: "node.py"
      contract_file: "contract.yaml"
      main_class_name: "MessageAggregator"

    # Service loading configuration
    service_integration:
      load_as_module: true
      requires_separate_port: false
      initialization_order: 4
      shutdown_timeout: 30
      health_check_via_service: true

# === EXECUTION METADATA ===
execution_mode: "async"
execution_constraints:
  max_memory_mb: 512
  max_cpu_percent: 40
  timeout_seconds: 120

# === TESTING METADATA ===
testing:
  required_ci_tiers:
    - "mock"
    - "integration"
  minimum_coverage_percentage: 85.0
  canonical_test_case_ids:
    - "test_message_aggregation"
    - "test_cross_group_coordination"
    - "test_state_management"

# === SECURITY METADATA ===
data_handling_declaration:
  processes_sensitive_data: false
  data_classification: "internal"

security_context:
  requires_network_access: true
  external_endpoints:
    - "postgresql://localhost:5432"

# === LOGGING CONFIGURATION ===
logging_config:
  level: "info"
  format: "json"
  audit_events:
    - "aggregator_initialized"
    - "message_aggregated"
    - "state_persisted"
    - "cross_group_coordination_completed"

tags:
  - "infrastructure"
  - "messaging"
  - "aggregation"
  - "cross-group"
  - "postgresql"
