# PerformanceMonitoringSubcontract - Metrics collection, performance tracking, and observability for ONEX nodes
# Generated from performance_monitoring.yaml using automated conversion

contract_type: performance_monitoring_subcontract
contract_version:
  major: 1
  minor: 0
  patch: 0
metadata:
  name: PerformanceMonitoringSubcontract
  description: Metrics collection, performance tracking, and observability for ONEX nodes
  author: ONEX Framework Team
  created: '2025-09-01'
  purpose: Define comprehensive performance monitoring patterns
  applicable_node_types:
    - COMPUTE
    - EFFECT
    - REDUCER
    - ORCHESTRATOR
business_logic:
  pattern: performance_monitoring
  ai_agent:
    capabilities:
      - performance_monitoring_management
    coordination_patterns:
      - performance_monitoring_coordination
    performance_targets:
      default_timeout: 30s
actions:
  collect_metrics:
    description: Collect current performance metrics
    operation_type: performance_monitoring
    inputs:
      metric_types:
        type: object
        description: Input parameter metric_types
        required: true
      aggregation_period:
        type: object
        description: Input parameter aggregation_period
        required: true
    outputs:
      metrics_data:
        type: ModelMetricsData
        description: Output data metrics_data
      collection_timestamp:
        type: ModelCollectionTimestamp
        description: Output data collection_timestamp
    required: true
    timeout_ms: 2000
  start_performance_trace:
    description: Start a performance trace for an operation
    operation_type: performance_monitoring
    inputs:
      operation_name:
        type: object
        description: Input parameter operation_name
        required: true
      trace_config:
        type: object
        description: Input parameter trace_config
        required: true
    outputs:
      trace_id:
        type: ModelTraceId
        description: Output data trace_id
      trace_context:
        type: ModelTraceContext
        description: Output data trace_context
    required: false
    timeout_ms: 500
  end_performance_trace:
    description: End a performance trace and record metrics
    operation_type: performance_monitoring
    inputs:
      trace_id:
        type: object
        description: Input parameter trace_id
        required: true
      operation_result:
        type: object
        description: Input parameter operation_result
        required: true
    outputs:
      trace_summary:
        type: ModelTraceSummary
        description: Output data trace_summary
      performance_metrics:
        type: ModelPerformanceMetrics
        description: Output data performance_metrics
    required: false
    timeout_ms: 1000
  get_performance_summary:
    description: Get performance summary over specified time period
    operation_type: performance_monitoring
    inputs:
      time_range:
        type: object
        description: Input parameter time_range
        required: true
      metric_filters:
        type: object
        description: Input parameter metric_filters
        required: true
    outputs:
      performance_summary:
        type: ModelPerformanceSummary
        description: Output data performance_summary
      trend_analysis:
        type: ModelTrendAnalysis
        description: Output data trend_analysis
    required: false
    timeout_ms: 3000
  configure_alerts:
    description: Configure performance alerts and thresholds
    operation_type: performance_monitoring
    inputs:
      alert_config:
        type: object
        description: Input parameter alert_config
        required: true
      notification_targets:
        type: object
        description: Input parameter notification_targets
        required: true
    outputs:
      alert_configuration:
        type: ModelAlertConfiguration
        description: Output data alert_configuration
      alert_status:
        type: ModelAlertStatus
        description: Output data alert_status
    required: false
    timeout_ms: 2000
output_models:
  ModelPerformanceMonitoringSubcontract:
    description: Main model for PerformanceMonitoringSubcontract
    fields:
      subcontract_name:
        type: str
        description: Name of the subcontract
        required: false
        default: performance_monitoring_subcontract
      subcontract_version:
        type: str
        description: Version of the subcontract
        required: false
        default: 1.0.0
      applicable_node_types:
        type: List[str]
        description: Node types this subcontract applies to
        required: false
        default:
          - COMPUTE
          - EFFECT
          - REDUCER
          - ORCHESTRATOR
      collection_interval_ms:
        type: int
        description: Metrics collection interval in milliseconds
        required: false
        default: 10000
      metric_retention_hours:
        type: int
        description: How long to retain metrics data in hours
        required: false
        default: 168
      enable_tracing:
        type: bool
        description: Whether performance tracing is enabled
        required: false
        default: true
      enable_alerts:
        type: bool
        description: Whether performance alerts are enabled
        required: false
        default: true
      max_trace_duration_ms:
        type: int
        description: Maximum duration for performance traces in milliseconds
        required: false
        default: 300000
      aggregation_intervals:
        type: List[int]
        description: Aggregation intervals for metrics in milliseconds
        required: false
        default:
          - 60000
          - 300000
          - 3600000
dependencies:
  - name: performance_monitoring_capability
    type: capability
    description: Provides performance monitoring capabilities
requires_dependencies:
  - name: protocol_performance_monitoring
    type: protocol
    description: Protocol for performance monitoring operations
    optional: true
metrics:
  - name: performance_monitoring_operations_total
    type: counter
    description: Total number of performance monitoring operations
    labels:
      - operation_type
      - success
  - name: performance_monitoring_operation_duration
    type: histogram
    description: Duration of performance monitoring operations
    labels:
      - operation_type
    buckets:
      - 10
      - 50
      - 100
      - 500
      - 1000
      - 5000
      - 30000
integration:
  main_contract_field: performance_monitoring_configuration
  mapping_strategy: direct_embedding
  backward_compatibility: true
