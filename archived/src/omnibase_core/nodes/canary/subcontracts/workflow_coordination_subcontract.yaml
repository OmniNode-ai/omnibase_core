# WorkflowCoordinationSubcontract - Workflow orchestration, task coordination, and execution management for ORCHESTRATOR nodes
# Generated from workflow_coordination.yaml using automated conversion

contract_type: workflow_coordination_subcontract
contract_version:
  major: 1
  minor: 0
  patch: 0
metadata:
  name: WorkflowCoordinationSubcontract
  description: Workflow orchestration, task coordination, and execution management for ORCHESTRATOR nodes
  author: ONEX Framework Team
  created: '2025-09-01'
  purpose: Define comprehensive workflow coordination patterns
  applicable_node_types:
    - ORCHESTRATOR
business_logic:
  pattern: workflow_coordination
  ai_agent:
    capabilities:
      - workflow_coordination_management
    coordination_patterns:
      - workflow_coordination_coordination
    performance_targets:
      default_timeout: 30s
actions:
  create_workflow:
    description: Create a new workflow execution instance
    operation_type: workflow_coordination
    inputs:
      workflow_definition:
        type: object
        description: Input parameter workflow_definition
        required: true
      input_parameters:
        type: object
        description: Input parameter input_parameters
        required: true
      execution_config:
        type: object
        description: Input parameter execution_config
        required: true
    outputs:
      workflow_instance:
        type: ModelWorkflowInstance
        description: Output data workflow_instance
      execution_id:
        type: ModelExecutionId
        description: Output data execution_id
    required: true
    timeout_ms: 5000
  execute_workflow:
    description: Execute workflow with coordinated node interactions
    operation_type: workflow_coordination
    inputs:
      workflow_instance:
        type: object
        description: Input parameter workflow_instance
        required: true
      execution_context:
        type: object
        description: Input parameter execution_context
        required: true
    outputs:
      execution_result:
        type: ModelExecutionResult
        description: Output data execution_result
      coordination_metrics:
        type: ModelCoordinationMetrics
        description: Output data coordination_metrics
    required: true
    timeout_ms: 300000
  coordinate_nodes:
    description: Coordinate execution across COMPUTE, EFFECT, and REDUCER nodes
    operation_type: workflow_coordination
    inputs:
      coordination_plan:
        type: object
        description: Input parameter coordination_plan
        required: true
      node_assignments:
        type: object
        description: Input parameter node_assignments
        required: true
      sync_requirements:
        type: object
        description: Input parameter sync_requirements
        required: true
    outputs:
      coordination_result:
        type: ModelCoordinationResult
        description: Output data coordination_result
      node_statuses:
        type: ModelNodeStatuses
        description: Output data node_statuses
    required: true
    timeout_ms: 60000
  monitor_workflow_progress:
    description: Monitor and track workflow execution progress
    operation_type: workflow_coordination
    inputs:
      workflow_id:
        type: object
        description: Input parameter workflow_id
        required: true
      monitoring_config:
        type: object
        description: Input parameter monitoring_config
        required: true
    outputs:
      progress_status:
        type: ModelProgressStatus
        description: Output data progress_status
      performance_metrics:
        type: ModelPerformanceMetrics
        description: Output data performance_metrics
    required: false
    timeout_ms: 2000
  handle_workflow_failure:
    description: Handle workflow failures with recovery strategies
    operation_type: workflow_coordination
    inputs:
      failure_context:
        type: object
        description: Input parameter failure_context
        required: true
      recovery_config:
        type: object
        description: Input parameter recovery_config
        required: true
      rollback_options:
        type: object
        description: Input parameter rollback_options
        required: true
    outputs:
      recovery_action:
        type: ModelRecoveryAction
        description: Output data recovery_action
      workflow_status:
        type: ModelWorkflowStatus
        description: Output data workflow_status
    required: true
    timeout_ms: 10000
output_models:
  ModelWorkflowCoordinationSubcontract:
    description: Main model for WorkflowCoordinationSubcontract
    fields:
      subcontract_name:
        type: str
        description: Name of the subcontract
        required: false
        default: workflow_coordination_subcontract
      subcontract_version:
        type: str
        description: Version of the subcontract
        required: false
        default: 1.0.0
      applicable_node_types:
        type: List[str]
        description: Node types this subcontract applies to (ORCHESTRATOR only)
        required: false
        default:
          - ORCHESTRATOR
      max_concurrent_workflows:
        type: int
        description: Maximum number of concurrent workflows
        required: false
        default: 10
      default_workflow_timeout_ms:
        type: int
        description: Default workflow timeout in milliseconds
        required: false
        default: 600000
      node_coordination_timeout_ms:
        type: int
        description: Node coordination timeout in milliseconds
        required: false
        default: 30000
      checkpoint_interval_ms:
        type: int
        description: Checkpoint interval in milliseconds
        required: false
        default: 60000
      auto_retry_enabled:
        type: bool
        description: Whether automatic retry is enabled
        required: false
        default: true
      parallel_execution_enabled:
        type: bool
        description: Whether parallel execution is enabled
        required: false
        default: true
      workflow_persistence_enabled:
        type: bool
        description: Whether workflow state persistence is enabled
        required: false
        default: true
      max_retries:
        type: int
        description: Maximum number of retries for failed operations
        required: false
        default: 3
      retry_delay_ms:
        type: int
        description: Delay between retries in milliseconds
        required: false
        default: 2000
      exponential_backoff:
        type: bool
        description: Whether to use exponential backoff for retries
        required: false
        default: true
dependencies:
  - name: workflow_coordination_capability
    type: capability
    description: Provides workflow coordination capabilities
requires_dependencies:
  - name: protocol_workflow_coordination
    type: protocol
    description: Protocol for workflow coordination operations
    optional: true
metrics:
  - name: workflows_created
    type: counter
    description: Total number of workflows created
    labels:
      - workflow_type
      - workflow_version
  - name: workflows_executed
    type: counter
    description: Total number of workflows executed
    labels:
      - workflow_type
      - status
      - execution_pattern
  - name: workflow_execution_time
    type: histogram
    description: Total workflow execution time
    labels:
      - workflow_type
      - execution_pattern
  - name: node_coordination_time
    type: histogram
    description: Time spent on node coordination
    labels:
      - node_type
      - coordination_type
  - name: active_workflows
    type: gauge
    description: Number of currently active workflows
    labels: []
  - name: coordination_failures
    type: counter
    description: Number of coordination failures
    labels:
      - failure_type
      - node_type
      - recovery_action
  - name: parallelism_utilization
    type: histogram
    description: Achieved parallelism as percentage of potential
    labels:
      - workflow_type
  - name: synchronization_delays
    type: histogram
    description: Delays caused by synchronization points
    labels:
      - synchronization_type
integration:
  main_contract_field: workflow_coordination_configuration
  mapping_strategy: direct_embedding
  backward_compatibility: true
